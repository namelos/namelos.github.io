<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-templates-post-js-bd41ec710cf6e1dcb1d1.js" as="script"/><link rel="preload" href="/path---sicp-exercise-ch-3-2102c65245a8e79f425c.js" as="script"/><link rel="preload" href="/app-be1a537b0f2ed3bb5aa3.js" as="script"/><link rel="preload" href="/commons-677a0f8e0293361e4134.js" as="script"/><style id="gatsby-inlined-css">body{font-size:14px;font-family:Palatino,Palatino Linotype,Palatino LT STD,Book Antiqua,Georgia,SimSun,serif;background-color:#fffff8;color:#111;width:70%;max-width:1024px;margin:0 auto}@media (max-width:1023px){body{width:96%}}h1,h2,h3{font-weight:400;line-height:1.4;font-style:italic}h1{font-size:2.2rem;margin-top:4rem}h1,h2{margin-bottom:0}h2{font-size:1.7rem;margin-top:2.1rem}h3{font-size:1.5rem;margin-top:2rem;margin-bottom:0}div,ol,ul{font-size:1rem}div,ol,p,ul{line-height:2rem}div,p{margin-top:1.2rem;margin-bottom:1.2rem;padding-right:0;vertical-align:baseline}blockquote,div,p{font-size:1.2rem}code{font-family:Courier,Consolas,Liberation Mono,Menlo,Hiragino Sans GB,Microsoft YaHei,SimHei,monospace;font-size:1rem;line-height:1.42rem}pre{margin-left:40px;margin-right:40px}blockquote,pre.verse{color:#444;font-size:1.4rem;width:55%;margin-right:40px;font-style:italic;font-family:Palatino,Palatino Linotype,Palatino LT STD,Book Antiqua,Georgia,SimSun,serif}li{margin-top:.25rem}strong{font-style:italic}a:link,a:visited{color:inherit}a:link{text-decoration:none;background:linear-gradient(#fffff8,#fffff8),linear-gradient(#fffff8,#fffff8),linear-gradient(#333,#333);background-size:.05em 1px,.05em 1px,1px 1px;background-repeat:no-repeat,no-repeat,repeat-x;text-shadow:.03em 0 #fffff8,-.03em 0 #fffff8,0 .03em #fffff8,0 -.03em #fffff8,.06em 0 #fffff8,-.06em 0 #fffff8,.09em 0 #fffff8,-.09em 0 #fffff8,.12em 0 #fffff8,-.12em 0 #fffff8,.15em 0 #fffff8,-.15em 0 #fffff8;background-position:0 93%,100% 93%,0 93%}a:link::-moz-selection{text-shadow:.03em 0 #b4d5fe,-.03em 0 #b4d5fe,0 .03em #b4d5fe,0 -.03em #b4d5fe,.06em 0 #b4d5fe,-.06em 0 #b4d5fe,.09em 0 #b4d5fe,-.09em 0 #b4d5fe,.12em 0 #b4d5fe,-.12em 0 #b4d5fe,.15em 0 #b4d5fe,-.15em 0 #b4d5fe;background:#b4d5fe}a:link::selection{text-shadow:.03em 0 #b4d5fe,-.03em 0 #b4d5fe,0 .03em #b4d5fe,0 -.03em #b4d5fe,.06em 0 #b4d5fe,-.06em 0 #b4d5fe,.09em 0 #b4d5fe,-.09em 0 #b4d5fe,.12em 0 #b4d5fe,-.12em 0 #b4d5fe,.15em 0 #b4d5fe,-.15em 0 #b4d5fe;background:#b4d5fe}hr{display:block;height:1px;width:55%;border:0;border-top:1px solid #ccc;margin:1em 0;padding:0}img{max-width:100%}table{font-family:Trebuchet MS,Gill Sans,Gill Sans MT,Hiragino Sans GB,Microsoft YaHei,SimHei,sans-serif;overflow-x:auto;margin-left:40px;margin-right:40px}</style></head><body><div id="___gatsby"><div data-reactroot=""><div><h1><a href="/">Namelos</a> / <!-- -->SICP Chapter 3 Exercises</h1><br/><small>2018-09-23</small><div><div class="section"><h1>Exercise 3.1</h1><div>An accumulator is a procedure that is called repeatedly with a single numeric argument and accumulates its arguments into a sum. Each time it is called, it returns the currently accumulated sum. Write a procedure make-accumulator that generates accumulators, each maintaining an independent sum. The input to make-accumulator should specify the initial value of the sum; for example</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> A <span class="token punctuation">(</span><span class="token function">make-accumulator</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token function">A</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">; => 10</span>
<span class="token punctuation">(</span><span class="token function">A</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">; => 25</span></code></pre><div>Solution:</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">make-accumulator</span> initial-value<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">(</span>delta<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">begin</span> <span class="token punctuation">(</span><span class="token keyword">set!</span> initial-value
             <span class="token punctuation">(</span><span class="token operator">+</span> initial-value delta<span class="token punctuation">)</span><span class="token punctuation">)</span>
           initial-value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div><div class="section"><h1>Exercise 3.2</h1><div>In software-testing applications, it is useful to be able to count the number of times a given procedure is called during the course of a computation. Write a procedure make-monitored that takes as input a procedure, f, that itself takes one input. The result returned by make-monitored is a third procedure, say mf, that keeps track of the number of times it has been called by maintaining an internal counter. If the input to mf is the special symbol how-many-calls?, then mf returns the value of the counter. If the input is the special symbol reset-count, then mf resets the counter to zero. For any other input, mf returns the result of calling f on that input and increments the counter. For instance, we could make a monitored version of the sqrt procedure:</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> s <span class="token punctuation">(</span><span class="token function">make-monitored</span> sqrt<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token function">s</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token comment">; => 10</span>
<span class="token punctuation">(</span><span class="token function">s</span> <span class="token string">'how-many-calls?)</span> <span class="token comment">; => 1</span></code></pre><div>Solution:</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">make-monitored</span> f<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">call-count</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span>how-many-calls?<span class="token punctuation">)</span>
      call-count<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span>reset-count<span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token keyword">set!</span> call-count <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">invoke</span> argument<span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token keyword">set!</span> call-count <span class="token punctuation">(</span><span class="token operator">+</span> call-count <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token function">f</span> argument<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">dispatch</span> m<span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">eq?</span> m <span class="token string">'how-many-calls?)</span> <span class="token punctuation">(</span>how-many-calls?<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">eq?</span> m <span class="token string">'reset-count)</span> <span class="token punctuation">(</span>reset-count<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">invoke</span> m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    dispatch<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div><div class="section"><h1>Exercise 3.3</h1><div>Modify the make-account procedure so that it creates password-protected accounts. That is, make-account should take a symbol as an additional argument, as in</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> acc <span class="token punctuation">(</span><span class="token function">make-account</span> <span class="token number">100</span> <span class="token string">'secret-password))</span></code></pre><div>The resulting account object should process a request only if it is accompanied by the password with which the account was created, and should otherwise return a complaint:</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">acc</span> <span class="token string">'secret-password</span> <span class="token string">'withdraw)</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token comment">; => 60</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">acc</span> <span class="token string">'some-other-password</span> <span class="token string">'deposit)</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment">; => "Incorrect password"</span></code></pre><div>Solution:</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">make-account</span> balance password<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">withdraw</span> amount<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">>=</span> balance amount<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">begin</span> <span class="token punctuation">(</span><span class="token keyword">set!</span> balance <span class="token punctuation">(</span><span class="token operator">-</span> balance amount<span class="token punctuation">)</span><span class="token punctuation">)</span>
               balance<span class="token punctuation">)</span>
        <span class="token string">"Insufficient funds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">deposit</span> amount<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">set!</span> balance <span class="token punctuation">(</span><span class="token operator">+</span> balance amount<span class="token punctuation">)</span><span class="token punctuation">)</span>
    balance<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">dispatch</span> password-input m<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">not</span> <span class="token punctuation">(</span><span class="token function">eq?</span> password password-input<span class="token punctuation">)</span><span class="token punctuation">)</span>
           <span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token string">"Incorrect password"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">eq?</span> m <span class="token string">'withdraw)</span> withdraw<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">eq?</span> m <span class="token string">'deposit)</span> deposit<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">error</span> <span class="token string">"Unknown request -- MAKE-ACCOUNT"</span> m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  dispatch<span class="token punctuation">)</span></code></pre></div><div class="section"><h1>Exercise 3.4</h1><div>Modify the make-account procedure of exercise 3.3 by adding another local state variable so that, if an account is accessed more than seven consecutive times with an incorrect password, it invokes the procedure call-the-cops.</div><div>Solution:</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">make-account</span> balance password<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">consecutive-failures</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span>call-cops<span class="token punctuation">)</span>
      <span class="token string">"Dialing!"</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span>increment-failures<span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token keyword">set!</span> consecutive-failures <span class="token punctuation">(</span><span class="token operator">+</span> consecutive-failures <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span>reset-consecutive-failures<span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token keyword">set!</span> consecutive-failures <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">withdraw</span> amount<span class="token punctuation">)</span>
      <span class="token punctuation">(</span>reset-consecutive-failures<span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">>=</span> balance amount<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token keyword">begin</span> <span class="token punctuation">(</span><span class="token keyword">set!</span> balance <span class="token punctuation">(</span><span class="token operator">-</span> balance amount<span class="token punctuation">)</span><span class="token punctuation">)</span>
                 balance<span class="token punctuation">)</span>
          <span class="token string">"Insufficient funds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">deposit</span> amount<span class="token punctuation">)</span>
      <span class="token punctuation">(</span>reset-consecutive-failures<span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token keyword">set!</span> balance <span class="token punctuation">(</span><span class="token operator">+</span> balance amount<span class="token punctuation">)</span><span class="token punctuation">)</span>
      balance<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">incorrect-password</span> amount<span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">>=</span> consecutive-failures <span class="token number">7</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>call-cops<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span>increment-failures<span class="token punctuation">)</span>
                  <span class="token string">"Incorrect password"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">dispatch</span> password-input m<span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">not</span> <span class="token punctuation">(</span><span class="token function">eq?</span> password password-input<span class="token punctuation">)</span><span class="token punctuation">)</span> incorrect-password<span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">eq?</span> m <span class="token string">'withdraw)</span> withdraw<span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">eq?</span> m <span class="token string">'deposit)</span> deposit<span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">error</span> <span class="token string">"Unknown request -- MAKE-ACCOUNT"</span> m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    dispatch<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div><div class="section"><h1>Exercise 3.7</h1><div>Consider the bank account objects created by make-account, with the password modification described in exercise 3.3. Suppose that our banking system requires the ability to make joint accounts. Define a procedure make-joint that accomplishes this. Make-joint should take three arguments. The first is a password-protected account. The second argument must match the password with which the account was defined in order for the make-joint operation to proceed. The third argument is a new password. Make-joint is to create an additional access to the original account using the new password. For example, if peter-acc is a bank account with password open-sesame, then</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> paul-acc
  <span class="token punctuation">(</span><span class="token function">make-joint</span> peter-acc <span class="token string">'open-sesame</span> <span class="token string">'rosebud))</span></code></pre><div>will allow one to make transactions on peter-acc using the name paul-acc and the password rosebud. You may wish to modify your solution to exercise 3.3 to accommodate this new feature.</div></div><div class="section"><h1>Exercise 3.8</h1><div>When we defined the evaluation model in section 1.1.3, we said that the first step in evaluating an expression is to evaluate its subexpressions. But we never specified the order in which the subexpressions should be evaluated (e.g., left to right or right to left). When we introduce assignment, the order in which the arguments to a procedure are evaluated can make a difference to the result. Define a simple procedure f such that evaluating (+ (f 0) (f 1)) will return 0 if the arguments to + are evaluated from left to right but will return 1 if the arguments are evaluated from right to left.</div></div><div class="section"><h1>Exercise 3.9</h1><div>In section 1.2.1 we used the substitution model to analyze two procedures for computing factorials, a recursive version</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">factorial</span> n<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">=</span> n <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token number">1</span>
      <span class="token punctuation">(</span><span class="token operator">*</span> n <span class="token punctuation">(</span><span class="token function">factorial</span> <span class="token punctuation">(</span><span class="token operator">-</span> n <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><div>and an iterative version</div><pre><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">factorial</span> n<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">fact-iter</span> <span class="token number">1</span> <span class="token number">1</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">fact-iter</span> product counter max-count<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">></span> counter max-count<span class="token punctuation">)</span>
      product
      <span class="token punctuation">(</span><span class="token function">fact-iter</span> <span class="token punctuation">(</span><span class="token operator">*</span> counter product<span class="token punctuation">)</span>
                 <span class="token punctuation">(</span><span class="token operator">+</span> counter <span class="token number">1</span><span class="token punctuation">)</span>
                 max-count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><div>Show the environment structures created by evaluating (factorial 6) using each version of the factorial procedure.</div></div></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-be1a537b0f2ed3bb5aa3.js","195351340454287":"component---src-templates-post-js-bd41ec710cf6e1dcb1d1.js","35783957827783":"component---src-pages-index-js-c9d0abba2b4b8c2a6417.js","132761184526123":"path---common-lisp-1-a4551446ed865884c17c.js","141830964309527":"path---sicp-1-22c766c8bd58c1f5083f.js","273302927040515":"path---sicp-0-968f3a6ca87563c641da.js","198341299720095":"path---lambda-let-binding-and-module-dd5275fe7066e9e2071b.js","93501619469393":"path---sicp-ch-1-a2cf77029f68b4a81d2f.js","170072518859038":"path---sicp-3-3-82c95303453e3072e156.js","9339818220304":"path---sicp-exercise-ch-3-2102c65245a8e79f425c.js","243524056326353":"path---sicp-3-2-1757296c6bc911dbcc8c.js","245939732109026":"path---sicp-2-1-f833854a951e9c611f18.js","43846261805915":"path---sicp-ch-2-b90c8c7069cc04b37d66.js","104189591922118":"path---common-lisp-0-691f0dd69c1781674384.js","142629428675168":"path---index-c5141a3c9f9dd2b08b69.js"}/*]]>*/</script><script>/*<![CDATA[*/["/commons-677a0f8e0293361e4134.js","/app-be1a537b0f2ed3bb5aa3.js","/path---sicp-exercise-ch-3-2102c65245a8e79f425c.js","/component---src-templates-post-js-bd41ec710cf6e1dcb1d1.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>